{% extends "base.html" %}
{% block content %}
<h2 class="text-center mb-4">üíº –í–∞—à –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ—Ä—Ç—Ñ–µ–ª—å</h2>

<form method="POST" class="mb-4">
  {{ form.hidden_tag() }}
  <div class="row g-3 align-items-center">
    <div class="col-md-4">
      {{ form.symbol.label }}{{ form.symbol(class="form-select") }}
      <small class="form-text text-muted">–í—ã–±–µ—Ä–∏—Ç–µ –∞–∫—Ç–∏–≤ –∏–∑ —Å–ø–∏—Å–∫–∞</small>
    </div>
    <div class="col-md-3">{{ form.quantity.label }}{{ form.quantity(class="form-control") }}</div>
    <div class="col-md-3">{{ form.buy_price.label }}{{ form.buy_price(class="form-control") }}</div>
    <div class="col-md-2">{{ form.submit(class="btn btn-success w-100") }}</div>
  </div>
</form>

<div class="mb-3">
  <strong>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:</strong>
  <a href="?sort=name" class="btn btn-sm btn-outline-primary">–ù–∞–∑–≤–∞–Ω–∏—é</a>
  <a href="?sort=profit" class="btn btn-sm btn-outline-primary">–ü—Ä–∏–±—ã–ª–∏</a>
  <a href="?sort=current" class="btn btn-sm btn-outline-primary">–¢–µ–∫—É—â–µ–π —Ü–µ–Ω–µ</a>
</div>

<table class="table table-bordered table-striped mt-3">
  <thead class="table-light">
    <tr>
      <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
      <th>–°–∏–º–≤–æ–ª</th>
      <th>–ö–æ–ª-–≤–æ</th>
      <th>–ü–æ–∫—É–ø–∫–∞ ($)</th>
      <th>–¢–µ–∫—É—â–∞—è ($)</th>
      <th>–ü—Ä–∏–±—ã–ª—å ($)</th>
      <th>–î–µ–π—Å—Ç–≤–∏—è</th>
    </tr>
  </thead>
  <tbody>
    {% for inv in investments %}
    <tr>
      <td>{{ inv.name }}</td>
      <td>{{ inv.symbol.upper() }}</td>
      <td>{{ "%.4f"|format(inv.quantity) }}</td>
      <td>{{ "%.2f"|format(inv.buy) }}</td>
      <td>
        {% if inv.current %}
          <span class="fw-bold text-success">{{ "%.2f"|format(inv.current) }}</span>
        {% else %}
          <span class="text-muted">‚è≥ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</span>
        {% endif %}
      </td>
      <td>
        {% if inv.profit is not none %}
          <span class="{{ 'text-success' if inv.profit >= 0 else 'text-danger' }}">
            {{ "%.2f"|format(inv.profit) }}
          </span>
        {% else %}
          <span class="text-muted">‚Äî</span>
        {% endif %}
      </td>
      <td>
        <a href="{{ url_for('portfolio.edit_investment', item_id=inv.id) }}"
           class="btn btn-sm btn-outline-primary">‚úèÔ∏è</a>
        <a href="{{ url_for('portfolio.delete_investment', item_id=inv.id) }}"
           class="btn btn-sm btn-outline-danger">‚úñ</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
